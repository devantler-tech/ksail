{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "properties": {
    "kind": {
      "type": "string",
      "enum": [
        "Cluster"
      ]
    },
    "apiVersion": {
      "type": "string",
      "enum": [
        "ksail.dev/v1alpha1"
      ]
    },
    "spec": {
      "properties": {
        "editor": {
          "type": "string",
          "description": "Editor command for interactive workflows (e.g. code --wait)"
        },
        "cluster": {
          "properties": {
            "distributionConfig": {
              "type": "string"
            },
            "connection": {
              "properties": {
                "kubeconfig": {
                  "type": "string"
                },
                "context": {
                  "type": "string"
                },
                "timeout": {
                  "type": "string",
                  "pattern": "^[0-9]+(ns|us|µs|ms|s|m|h)$"
                }
              },
              "additionalProperties": false,
              "type": "object",
              "required": [
                "kubeconfig",
                "context",
                "timeout"
              ]
            },
            "distribution": {
              "type": "string",
              "enum": [
                "Kind",
                "K3d"
              ]
            },
            "cni": {
              "type": "string",
              "enum": [
                "Default",
                "Cilium",
                "Calico"
              ]
            },
            "csi": {
              "type": "string",
              "enum": [
                "Default",
                "LocalPathStorage"
              ]
            },
            "metricsServer": {
              "type": "string",
              "enum": [
                "Enabled",
                "Disabled"
              ]
            },
            "certManager": {
              "type": "string",
              "enum": [
                "Enabled",
                "Disabled"
              ]
            },
            "localRegistry": {
              "type": "string",
              "enum": [
                "Enabled",
                "Disabled"
              ]
            },
            "gitOpsEngine": {
              "type": "string",
              "enum": [
                "None",
                "Flux",
                "ArgoCD"
              ]
            },
            "options": {
              "properties": {
                "kind": {
                  "properties": {},
                  "additionalProperties": false,
                  "type": "object"
                },
                "k3d": {
                  "properties": {},
                  "additionalProperties": false,
                  "type": "object"
                },
                "cilium": {
                  "properties": {},
                  "additionalProperties": false,
                  "type": "object"
                },
                "calico": {
                  "properties": {},
                  "additionalProperties": false,
                  "type": "object"
                },
                "flux": {
                  "properties": {
                    "interval": {
                      "type": "string",
                      "pattern": "^[0-9]+(ns|us|µs|ms|s|m|h)$"
                    }
                  },
                  "additionalProperties": false,
                  "type": "object",
                  "required": [
                    "interval"
                  ]
                },
                "argocd": {
                  "properties": {},
                  "additionalProperties": false,
                  "type": "object"
                },
                "localRegistry": {
                  "properties": {
                    "hostPort": {
                      "type": "integer"
                    }
                  },
                  "additionalProperties": false,
                  "type": "object",
                  "required": [
                    "hostPort"
                  ]
                },
                "helm": {
                  "properties": {},
                  "additionalProperties": false,
                  "type": "object"
                },
                "kustomize": {
                  "properties": {},
                  "additionalProperties": false,
                  "type": "object"
                }
              },
              "additionalProperties": false,
              "type": "object",
              "required": [
                "kind",
                "k3d",
                "cilium",
                "calico",
                "flux",
                "argocd",
                "localRegistry",
                "helm",
                "kustomize"
              ]
            }
          },
          "additionalProperties": false,
          "type": "object",
          "required": [
            "distributionConfig",
            "connection",
            "distribution",
            "cni",
            "csi",
            "metricsServer",
            "certManager",
            "localRegistry",
            "gitOpsEngine",
            "options"
          ]
        },
        "workload": {
          "properties": {
            "sourceDirectory": {
              "type": "string"
            },
            "validateOnPush": {
              "type": "boolean",
              "description": "Enable validation of workloads before pushing to OCI registry"
            }
          },
          "additionalProperties": false,
          "type": "object",
          "required": [
            "sourceDirectory",
            "validateOnPush"
          ]
        }
      },
      "additionalProperties": false,
      "type": "object"
    }
  },
  "additionalProperties": false,
  "type": "object",
  "required": [
    "spec"
  ],
  "title": "KSail Cluster Configuration",
  "description": "JSON schema for KSail cluster configuration (ksail.yaml)"
}